<!-- postcode action form -->
{% if page.action_form == "postcode" %}
<div class="panel panel-primary">
    <div class="panel-heading">
        <h3 class="panel-title">Action Form</h3>
    </div>
    <div class="panel-body">
        <h5>Enter your postcode...</h5>

        <div class="input-group">
            <input id="postcode_input" class="form-control" type="text" placeholder="Postcode">
            <span class="input-group-btn">
                <button id="postcode_go" class="btn btn-primary" type="submit">Find your legislators</button>
            </span>
        </div>


        <div class="legislators-div">
            <!-- <h4>legislators</h4> -->
        </div>


    </div>
</div>



<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

    $('#postcode_go').click(function() {
        $('.legislators-div').empty();

        var postcode = $('#postcode_input').val();

        $.getJSON('http://legislators-api.herokuapp.com/legislators?postcode='+postcode, function(data) {

             $('.legislators-div').append('<br />');

            for (var i = 0; i < data.legislators.length; i++) {

             $('.legislators-div').append('<img class="legislator-img" src="'+data.legislators[i].img_url+'">');   
             $('.legislators-div').append('<p>'+data.legislators[i].name+'</p>');   

             $('.legislators-div').append('<div class="contact-info" style="display:none;">');
            
             if(data.legislators[i].twitter){
             $('.legislators-div').append('<a href="'+data.legislators[i].twitter+'" target="_blank"><i class="fa fa-twitter fa-2x"></i>Twitter</a>');  
             }

             if(data.legislators[i].contact_form){
             $('.legislators-div').append('<a href="'+data.legislators[i].contact_form+'" target="_blank"><i class="fa fa-envelope fa-2x"></i>Email</a>');  
             }

             $('.legislators-div').append('</div>');

             // $('.legislators-div').append('<button type="button" class="btn btn-success contact-btn">Contact</button>');
             $('.legislators-div').append('<br />');
             $('.legislators-div').append('<br />');
             $('.legislators-div').append('<br />');
            // alert(data.legislators[i].name);
            };
        });
    });
});
</script>

<style type="text/css">
    .legislator-img{
        float: left;
        height:auto;
        width:50px;
    }
    .contact-btn{
        float: right;
    }
</style>
{% endif %}
